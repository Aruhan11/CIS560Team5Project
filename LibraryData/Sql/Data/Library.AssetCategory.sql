DECLARE @AssetCategoryStaging TABLE
(
   AssetID TINYINT NOT NULL,
   CategoryID TINYINT NOT NULL
);



INSERT @AssetCategoryStaging(AssetID,CategoryID)
VALUES
 (1, 13),
 (1, 14),
 (2, 4),
 (3, 7),
 (4, 1),
 (4, 2),
 (5, 13),
 (6, 3),
 (7, 8),
 (8, 11),
 (8, 3),
 (9, 15),
 (10, 16),
 (11, 5),
 (12, 6),
 (13, 17),
 (14, 9),
 (15, 12),
 (16, 10),
 (17, 15),
 (17, 4),
 (18, 2),
 (19, 5),
 (19, 16),
 (20, 14),
 (20, 12),
 (21, 7),
 (22, 1),
 (23, 11),
 (24, 5),
 (24, 8),
 (25, 13),
 (26, 15),
 (27, 1),
 (27, 3),
 (28, 2),
 (29, 17),
 (30, 2),
 (30, 4),
 (31, 9),
 (32, 12),
 (33, 11),
 (34, 6),
 (35, 8),
 (36, 7),
 (37, 8),
 (37, 10),
 (38, 16),
 (39, 11),
 (40, 13),
 (41, 9),
 (41, 5),
 (42, 2),
 (43, 17),
 (44, 13),
 (44, 12),
 (45, 7),
 (46, 4),
 (47, 4),
 (48, 15),
 (48, 17),
 (49, 10),
 (50, 9),
 (51, 1),
 (52, 3),
 (52, 16),
 (53, 11),
 (54, 2),
 (55, 8),
 (56, 13),
 (57, 10),
 (57, 2),
 (58, 6),
 (59, 4),
 (60, 8),
 (61, 11),
 (62, 1),
 (63, 2),
 (63, 16),
 (64, 12),
 (65, 7),
 (65, 6),
 (66, 11),
 (67, 14),
 (68, 3),
 (69, 2),
 (69, 9),
 (70, 15),
 (71, 5),
 (72, 4),
 (72, 1),
 (73, 16),
 (74, 8),
 (75, 17),
 (76, 10),
 (77, 13),
 (77, 4),
 (78, 11),
 (79, 12),
 (80, 16),
 (81, 7),
 (82, 2),
 (82, 5),
 (83, 9),
 (84, 13),
 (85, 6),
 (86, 14),
 (87, 3),
 (88, 1),
 (88, 10),
 (89, 16),
 (89, 5),
 (90, 4),
 (91, 13),
 (92, 11),
 (92, 12),
 (93, 7),
 (94, 8),
 (95, 8),
 (96, 12),
 (96, 13),
 (97, 9),
 (98, 1),
 (99, 2),
 (99, 3),
 (100, 15),
 (101, 10),
 (102, 5),
 (103, 11),
 (104, 14),
 (104, 1),
 (105, 6),
 (106, 3),
 (107, 13),
 (108, 2),
 (109, 3),
 (109, 15),
 (110, 14),
 (110, 4),
 (111, 11),
 (112, 1),
 (113, 8),
 (113, 9),
 (114, 5),
 (115, 2),
 (116, 6),
 (117, 7),
 (118, 10),
 (118, 11),
 (119, 16),
 (120, 6),
 (121, 7),
 (122, 2),
 (122, 3),
 (123, 17),
 (124, 10),
 (125, 5),
 (126, 15),
 (127, 8),
 (127, 16),
 (128, 9),
 (129, 1),
 (130, 8),
 (131, 1),
 (131, 2),
 (132, 16),
 (133, 11),
 (134, 10),
 (135, 13),
 (135, 12),
 (136, 14),
 (137, 3),
 (138, 3),
 (138, 4),
 (139, 8),
 (140, 9),
 (141, 12),
 (142, 16),
 (143, 10),
 (144, 11),
 (144, 1),
 (145, 13),
 (146, 3),
 (147, 17),
 (148, 16),
 (149, 11),
 (150, 4),
 (150, 5),
 (151, 9),
 (152, 10),
 (153, 7),
 (154, 11),
 (154, 16),
 (155, 9),
 (156, 8),
 (156, 5),
 (157, 3),
 (158, 10),
 (159, 6),
 (160, 14),
 (160, 17),
 (161, 13),
 (162, 10),
 (163, 10),
 (164, 5),
 (165, 3),
 (165, 1),
 (166, 10),
 (167, 16),
 (168, 17),
 (169, 8),
 (170, 10),
 (170, 11),
 (171, 4),
 (172, 14),
 (173, 7),
 (174, 3),
 (174, 16),
 (175, 1),
 (176, 2),
 (177, 6),
 (178, 16),
 (178, 17),
 (179, 5),
 (180, 15),
 (181, 8),
 (182, 8),
 (182, 9),
 (183, 12),
 (184, 11),
 (185, 3),
 (185, 1),
 (186, 13),
 (187, 5),
 (188, 11),
 (188, 6),
 (189, 2),
 (190, 7),
 (191, 2),
 (192, 16),
 (193, 14),
 (194, 10),
 (194, 9),
 (195, 11),
 (196, 5),
 (197, 8),
 (198, 6),
 (199, 3),
 (200, 1),
 (200, 4);




MERGE [Library].[AssetCategory] T
USING @AssetCategoryStaging S ON S.AssetID = T.AssetID
WHEN MATCHED AND S.AssetID <> T.AssetID AND  S.CategoryID <> T.CategoryID THEN
   UPDATE
   SET AssetID = S.AssetID,
		CategoryID = S.CategoryID
WHEN NOT MATCHED THEN
   INSERT(AssetID,CategoryID)
   VALUES(S.AssetID,S.CategoryID);