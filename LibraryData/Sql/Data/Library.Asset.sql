DECLARE @AssetStaging TABLE
(
    [Name] NVARCHAR(64) NOT NULL,
    AssetTypeID TINYINT NOT NULL ,
    CreatorID INT NOT NULL,
    ReleaseDate DATETIME2 NOT NULL DEFAULT('0000-00-00'),
    Stock INT NOT NULL
);



INSERT @AssetStaging([Name],AssetTypeID,CreatorID,ReleaseDate,Stock)
VALUES
 (N'hac habitasse platea dictumst', 4, 1, '1992-05-17', 1),
 (N'donec quis orci eget', 3, 2, '2013-04-27', 2),
 (N'lectus suspendisse', 2, 3, '2010-07-01', 1),
 (N'a suscipit', 1, 4, '1927-07-31', 2),
 (N'faucibus', 3, 5, '2014-10-09', 1),
 (N'eros', 1, 6, '1992-06-29', 2),
 (N'sem duis', 3, 7, '1941-05-01', 1),
 (N'turpis elementum', 2, 8, '1959-02-27', 3),
 (N'nulla', 4, 9, '1956-04-16', 1),
 (N'dictumst maecenas', 4, 10, '1955-10-14', 1),
 (N'eget tempus', 1, 11, '1903-05-18', 2),
 (N'semper rutrum nulla', 1, 12, '1944-02-20', 2),
 (N'est risus auctor sed', 4, 13, '1936-09-23', 3),
 (N'donec posuere', 1, 14, '1911-12-11', 1),
 (N'eu', 4, 15, '1992-12-31', 1),
 (N'rutrum at', 3, 16, '1967-04-08', 1),
 (N'eget', 4, 17, '1997-04-28', 2),
 (N'neque', 1, 18, '1947-06-23', 1),
 (N'quis', 2, 19, '1929-12-09', 2),
 (N'pharetra', 4, 20, '2001-04-03', 3),
 (N'fermentum donec ut', 1, 21, '1987-11-25', 1),
 (N'est phasellus sit amet', 1, 22, '1944-07-19', 3),
 (N'sit', 1, 23, '1953-04-20', 1),
 (N'scelerisque', 3, 24, '1986-09-01', 1),
 (N'nunc purus', 4, 25, '2010-02-05', 1),
 (N'justo in hac habitasse', 4, 26, '1941-10-16', 1),
 (N'id nulla', 3, 27, '1991-07-19', 3),
 (N'sit amet turpis elementum', 2, 28, '1998-02-23', 1),
 (N'volutpat sapien', 4, 29, '2014-04-22', 1),
 (N'tortor duis', 1, 30, '1940-05-03', 1),
 (N'eleifend donec', 1, 31, '1930-11-24', 1),
 (N'elit proin', 4, 32, '1999-12-04', 1),
 (N'vestibulum ante', 4, 33, '1915-05-24', 3),
 (N'justo morbi ut', 1, 34, '2012-08-28', 2),
 (N'eleifend luctus', 3, 35, '2017-02-23', 1),
 (N'risus praesent lectus vestibulum', 1, 36, '1989-11-22', 1),
 (N'et ultrices', 1, 37, '1993-12-03', 1),
 (N'interdum venenatis', 2, 38, '1998-02-22', 1),
 (N'aliquam', 3, 39, '1935-07-30', 1),
 (N'in libero ut', 3, 40, '1918-08-22', 2),
 (N'metus sapien', 1, 41, '1909-08-25', 1),
 (N'nulla ut erat id', 3, 42, '1977-04-13', 1),
 (N'montes', 4, 43, '1952-01-09', 1),
 (N'nulla mollis molestie lorem', 4, 44, '1903-07-11', 2),
 (N'nisl duis', 3, 45, '1967-12-12', 3),
 (N'eu orci', 1, 46, '1962-01-17', 3),
 (N'lobortis ligula sit amet', 3, 47, '1997-09-20', 1),
 (N'consectetuer eget rutrum', 4, 48, '2015-03-14', 1),
 (N'nisl nunc rhoncus', 1, 49, '1934-11-07', 1),
 (N'dapibus', 2, 50, '1959-11-28', 2),
 (N'nulla ut erat', 1, 51, '1974-02-04', 1),
 (N'sit amet', 1, 52, '1914-12-09', 2),
 (N'velit', 2, 53, '2012-06-13', 2),
 (N'nisi venenatis tristique', 1, 54, '1946-03-21', 2),
 (N'fringilla rhoncus', 2, 55, '1935-08-02', 1),
 (N'in', 3, 56, '1959-05-25', 1),
 (N'iaculis', 3, 57, '1920-02-04', 1),
 (N'interdum in ante', 4, 58, '1963-04-26', 1),
 (N'pede justo lacinia eget', 4, 59, '2018-02-02', 1),
 (N'proin interdum mauris', 3, 60, '1930-02-07', 3),
 (N'nulla tempus', 2, 61, '1919-07-11', 1),
 (N'nulla neque libero convallis', 3, 62, '1983-07-28', 1),
 (N'duis', 1, 63, '2001-01-28', 3),
 (N'quisque id justo', 4, 64, '1947-09-06', 2),
 (N'fermentum', 3, 65, '1999-02-12', 3),
 (N'sapien ut nunc vestibulum', 1, 66, '1973-07-08', 2),
 (N'tempus vivamus in felis', 4, 67, '1947-12-12', 1),
 (N'dictumst etiam faucibus', 2, 68, '1996-09-25', 1),
 (N'justo aliquam quis turpis', 1, 69, '1939-11-22', 1),
 (N'sapien', 4, 70, '1945-02-27', 1),
 (N'elit proin risus', 1, 71, '2005-06-13', 3),
 (N'rhoncus', 1, 72, '1946-06-14', 1),
 (N'parturient montes nascetur ridiculus', 1, 73, '1941-12-15', 2),
 (N'consequat nulla nisl', 2, 74, '1929-05-17', 1),
 (N'nullam molestie nibh in', 4, 75, '1954-03-30', 1),
 (N'laoreet ut rhoncus', 1, 76, '2013-01-05', 1),
 (N'iaculis congue', 4, 77, '1990-06-24', 1),
 (N'in sagittis dui vel', 2, 78, '1988-03-06', 1),
 (N'ultrices', 4, 79, '1978-04-14', 3),
 (N'curae mauris viverra', 1, 80, '1972-11-22', 1),
 (N'ultricies eu', 1, 81, '1984-10-09', 1),
 (N'nisl duis', 3, 82, '1909-06-04', 1),
 (N'curabitur at ipsum ac', 1, 83, '1973-01-19', 1),
 (N'quam pede', 3, 84, '1922-03-04', 1),
 (N'aliquam', 1, 85, '1982-09-09', 1),
 (N'justo lacinia', 4, 86, '2013-10-31', 1),
 (N'tortor eu', 3, 87, '1922-10-03', 3),
 (N'justo etiam pretium iaculis', 1, 88, '1907-03-29', 1),
 (N'ligula sit', 1, 89, '1913-01-03', 2),
 (N'vel ipsum praesent', 1, 90, '1972-06-24', 3),
 (N'tempor turpis nec', 3, 91, '2000-03-17', 2),
 (N'non', 4, 92, '1951-01-23', 3),
 (N'pede', 1, 93, '2015-05-28', 1),
 (N'eget eleifend luctus', 1, 94, '1907-11-28', 1),
 (N'quis turpis', 3, 95, '1974-01-24', 1),
 (N'ante vel ipsum praesent', 4, 96, '1980-06-20', 1),
 (N'id luctus nec', 3, 97, '1904-12-07', 1),
 (N'justo aliquam quis turpis', 2, 98, '1914-11-10', 1),
 (N'a libero', 1, 99, '2010-06-10', 1),
 (N'odio in', 4, 100, '1918-05-12', 1),
 (N'pede malesuada in', 3, 1, '2002-12-14', 2),
 (N'sapien cum sociis natoque', 2, 2, '1939-05-17', 3),
 (N'neque', 2, 3, '2010-01-06', 1),
 (N'nibh', 4, 4, '1978-10-21', 1),
 (N'diam erat fermentum', 2, 5, '1912-06-30', 3),
 (N'enim blandit', 1, 6, '1973-03-25', 1),
 (N'aliquet', 3, 7, '1937-03-22', 1),
 (N'nulla justo aliquam quis', 3, 8, '2016-11-09', 3),
 (N'ultrices posuere cubilia', 4, 9, '1972-07-24', 3),
 (N'porta volutpat', 4, 10, '2007-07-06', 3),
 (N'id consequat in', 3, 11, '1933-05-06', 3),
 (N'pede venenatis non', 3, 12, '1999-02-16', 1),
 (N'vivamus vestibulum', 1, 13, '1929-10-22', 3),
 (N'sapien ut', 1, 14, '1960-02-23', 3),
 (N'nulla neque libero convallis', 2, 15, '1958-12-01', 1),
 (N'rutrum nulla nunc purus', 1, 16, '1920-07-10', 1),
 (N'lorem integer tincidunt ante', 3, 17, '1985-10-30', 2),
 (N'potenti', 3, 18, '2017-01-15', 1),
 (N'posuere cubilia curae duis', 1, 19, '1992-11-01', 2),
 (N'rutrum rutrum neque aenean', 2, 20, '1975-10-31', 1),
 (N'sapien arcu', 2, 21, '1963-05-16', 1),
 (N'ligula pellentesque ultrices phasellus', 3, 22, '1946-05-27', 2),
 (N'eget vulputate ut', 4, 23, '1982-01-03', 1),
 (N'in faucibus', 2, 24, '1981-08-30', 1),
 (N'morbi sem mauris', 2, 25, '1921-05-06', 3),
 (N'integer pede justo lacinia', 4, 26, '1916-10-09', 1),
 (N'vivamus metus arcu adipiscing', 2, 27, '1995-11-04', 2),
 (N'in lacus curabitur at', 1, 28, '1934-06-12', 3),
 (N'erat', 3, 29, '1952-11-28', 1),
 (N'rutrum at lorem integer', 3, 30, '1971-11-27', 1),
 (N'in lacus curabitur at', 1, 31, '1930-11-02', 2),
 (N'pretium', 2, 32, '2014-02-25', 1),
 (N'orci luctus et ultrices', 2, 33, '1922-10-20', 2),
 (N'luctus cum sociis', 1, 34, '1988-03-19', 1),
 (N'mauris sit amet', 3, 35, '1912-12-31', 1),
 (N'adipiscing', 4, 36, '1963-08-26', 3),
 (N'vestibulum sagittis sapien cum', 1, 37, '1997-06-29', 1),
 (N'eget congue eget semper', 1, 38, '1989-07-24', 1),
 (N'velit donec', 1, 39, '1931-01-19', 3),
 (N'lectus in quam fringilla', 1, 40, '1945-09-21', 1),
 (N'neque sapien placerat ante', 3, 41, '1949-06-22', 1),
 (N'nibh in', 4, 42, '1931-07-24', 1),
 (N'nisl ut volutpat sapien', 4, 43, '1932-10-03', 1),
 (N'nam congue risus', 3, 44, '2014-07-18', 3),
 (N'nulla suscipit', 4, 45, '1971-05-06', 1),
 (N'pede morbi', 1, 46, '1990-02-02', 1),
 (N'dolor sit amet consectetuer', 4, 47, '1981-05-30', 1),
 (N'nunc commodo', 2, 48, '1922-09-09', 1),
 (N'odio condimentum', 1, 49, '1968-06-12', 1),
 (N'imperdiet et commodo vulputate', 2, 50, '2018-09-09', 2),
 (N'ac', 3, 51, '1964-06-14', 2),
 (N'ac consequat metus', 1, 52, '1965-12-30', 1),
 (N'sodales scelerisque', 1, 53, '1960-06-07', 1),
 (N'nibh ligula nec sem', 1, 54, '1933-07-15', 1),
 (N'ac nibh fusce lacus', 2, 55, '2007-11-07', 1),
 (N'in', 1, 56, '1919-06-25', 1),
 (N'ornare imperdiet sapien urna', 1, 57, '1923-11-16', 1),
 (N'porttitor pede', 3, 58, '1998-08-08', 2),
 (N'id lobortis', 4, 59, '1907-09-16', 2),
 (N'quam a odio in', 4, 60, '2002-09-13', 3),
 (N'venenatis non sodales', 3, 61, '1944-10-21', 1),
 (N'erat tortor', 3, 62, '1968-05-10', 1),
 (N'pretium quis lectus suspendisse', 1, 63, '1905-02-12', 1),
 (N'sapien a libero', 2, 64, '1947-09-24', 1),
 (N'tincidunt nulla mollis molestie', 1, 65, '1996-10-18', 1),
 (N'aliquam sit amet diam', 4, 66, '1978-07-26', 2),
 (N'pellentesque eget', 2, 67, '2000-04-14', 2),
 (N'vehicula', 4, 68, '2009-11-15', 2),
 (N'lectus in est', 1, 69, '2003-07-02', 1),
 (N'est lacinia nisi', 1, 70, '1906-04-12', 1),
 (N'turpis', 3, 71, '1935-06-11', 2),
 (N'amet cursus id', 4, 72, '1995-04-04', 1),
 (N'pretium iaculis', 1, 73, '1960-02-20', 1),
 (N'rutrum at lorem integer', 1, 74, '1907-10-15', 2),
 (N'morbi', 1, 75, '1999-07-06', 1),
 (N'congue etiam', 2, 76, '1977-02-23', 1),
 (N'magna vestibulum', 1, 77, '1925-07-19', 2),
 (N'tempor turpis', 4, 78, '1970-07-23', 1),
 (N'nulla', 1, 79, '1900-06-29', 1),
 (N'ultrices phasellus id sapien', 4, 80, '1975-07-29', 1),
 (N'purus', 2, 81, '1940-05-02', 1),
 (N'elit ac nulla', 1, 82, '1963-09-29', 2),
 (N'malesuada', 4, 83, '1901-09-27', 1),
 (N'nullam varius nulla', 4, 84, '1962-04-17', 1),
 (N'in', 1, 85, '1920-07-12', 1),
 (N'nisl aenean lectus pellentesque', 3, 86, '1942-03-18', 1),
 (N'amet lobortis sapien', 2, 87, '1967-05-18', 3),
 (N'cras non velit', 1, 88, '1931-04-03', 2),
 (N'lectus pellentesque at nulla', 1, 89, '1939-05-25', 3),
 (N'placerat praesent blandit nam', 2, 90, '1984-01-29', 1),
 (N'velit donec diam neque', 1, 91, '2013-06-12', 1),
 (N'sollicitudin', 1, 92, '1901-07-18', 2),
 (N'ornare imperdiet sapien', 4, 93, '1935-06-04', 1),
 (N'in faucibus orci luctus', 2, 94, '2006-04-13', 1),
 (N'primis in faucibus', 2, 95, '1992-04-24', 1),
 (N'justo eu massa', 1, 96, '1997-05-12', 1),
 (N'hendrerit at vulputate', 2, 97, '1952-12-14', 2),
 (N'dapibus augue', 2, 98, '1996-08-06', 1),
 (N'tempus vel', 1, 99, '1915-12-13', 3),
 (N'sed interdum venenatis turpis', 1, 100, '1919-07-31', 1),
 (N'A Love Stroy', 3, 1,'2014-11-15', 3);




MERGE [Library].[Asset] T
USING @AssetStaging S ON S.AssetTypeID = T.AssetTypeID
WHEN MATCHED AND S.AssetTypeID <> T.AssetTypeID AND  S.CreatorID <> T.CreatorID THEN
   UPDATE
   SET AssetTypeID = S.AssetTypeID,
		CreatorID = S.CreatorID
WHEN NOT MATCHED THEN
   INSERT([Name],AssetTypeID,CreatorID,ReleaseDate,Stock)
   VALUES(S.[Name], S.AssetTypeID,S.CreatorID,S.ReleaseDate,S.Stock);


	